generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  PROFESSOR
  ALUNO
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  nome      String
  role      UserRole @default(ALUNO)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relacionamentos
  professorProfile Professor?
  alunoProfile     Aluno?

  @@map("users")
}

model Professor {
  id     String @id @default(uuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  telefone      String?
  especialidade String?

  // Um professor tem muitos alunos
  alunos Aluno[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("professores")
}

model Aluno {
  id     String @id @default(uuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  professorId String
  professor   Professor @relation(fields: [professorId], references: [id])

  // Dados físicos e hábitos alimentares
  telefone  String?
  alturaCm  Int?
  pesoKg    Float?
  idade     Int?
  cinturaCm Int?
  quadrilCm Int?
  pescocoCm Int?

  alimentos_quer_diario         Json?
  alimentos_nao_comem           Json?
  alergias_alimentares          Json?
  dores_articulares             String?
  suplementos_consumidos        Json?
  dias_treino_semana            Int?
  frequencia_horarios_refeicoes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("alunos")
}

// Mantém a tabela antiga para não perder dados (vamos migrar depois)
model UserAnswer {
  id                            String   @id @default(uuid())
  createdAt                     DateTime @default(now())
  alturaCm                      Int?
  nome                          String
  email                         String
  telefone                      String?
  pesoKg                        Float?
  idade                         Int?
  cinturaCm                     Int?
  quadrilCm                     Int?
  pescocoCm                     Int?
  alimentos_quer_diario         Json?
  alimentos_nao_comem           Json?
  alergias_alimentares          Json?
  dores_articulares             String?
  suplementos_consumidos        Json?
  dias_treino_semana            Int?
  frequencia_horarios_refeicoes String?

  @@map("user_answers")
}
